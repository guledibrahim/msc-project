<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!--scripts-->
    <script src="Javascript/radviz.js"></script>
    <script src="https://d3js.org/d3.v3.min.js"></script> 
    <style>
      .container svg{
          margin-left: -70px;
      }
      svg .bg{
        fill: red;
      }

    </style>


    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="CSS/style.css">
  </head>
  <body>

  <!--navigation bar-->
    <nav class="navbar navbar-inverse bg-primary text-lg-center">
      <a class="navbar-brand" href="#">NCD-RisC RadViz Visualization</a>
    </nav>

    <div style="padding-top: 25px;" class="container-fluid">

    <div class="row">
        <!--left content-->
        <div class="col-md-3">
            <form class="form-group">
              <h6 style="padding-bottom: 10px; margin-bottom: 10px" class="font-weight-bold">Region</h6>

<!--drop down NA-->
<p>
  <a style="margin-bottom:5px;" class="btn btn-primary" data-toggle="collapse" href="#collapseExample" aria-expanded="false" aria-controls="collapseExample" data-target="#north-america">North America<!--<input style="margin-left: 5px; " type="checkbox"  class="Region"  id="CLA" name="CLA" value="Region" >--></a><br>
</p>
    <div class="collapse" id="north-america">
        <div class="card card-block">
                      <p >United States of America <input type="checkbox" class="Country" name="NA" id="NA" value="United States of America" checked></p>
                      <p>Canada&nbsp;<input type="checkbox" class="Country" name="NA" id="NA" value="Canada" checked></p>
    </div>
</div>

<!--drop down for CLA-->
<p>
  <a style="margin-bottom:5px;" class="btn btn-warning" data-toggle="collapse" href="#collapseExample" aria-expanded="false" aria-controls="collapseExample">Central Latin America <!--<input style="margin-left: 5px; " type="checkbox"  class="Region"  id="CLA" name="CLA" value="Region">--> </a><br>
</p>
    <div class="collapse" id="collapseExample">
      <div class="card card-block">
              <p>Mexico <input type="checkbox"  class="Country"  id="CLA" name="CLA" value="Mexico" checked></p>
              <p>Costa Rica <input type="checkbox"  class="Country"  id="CLA" name="CLA" value="Costa Rica" checked></p>
    </div>
</div>


<!--drop down for Carribbean--> 
<p>
  <a style="margin-bottom:5px; background-color: #962ab7; color: white;" class="btn btn-secondary" data-toggle="collapse" href="#collapseExample" aria-expanded="false" aria-controls="collapseExample" data-target="#Carribbean">Carribbean</a><br>
</p>
    <div class="collapse" id="Carribbean">
      <div class="card card-block">
                    <p">Bermuda <input type="checkbox" class="Country"  id="CC" name="CC" value="Bermuda" checked></p>
                    <p">Puerto Rico <input type="checkbox" class="Country"  id="CC" name="CC" value="Puerto Rico" checked></p>
    </div>
</div>



<!--drop down for Andean Latin Amaerica-->
<p style="margin-bottom:10px; ">
  <a style="margin-bottom:5px;" class="btn btn-success" data-toggle="collapse" href="#collapseExample" aria-expanded="false" aria-controls="collapseExample" data-target="#andean-latin-america">Andean Latin America <!--<input style="margin-left: 5px; " type="checkbox"  class="Region"  id="CLA" name="CLA" value="Region" >--></a><br>
</p>
    <div class="collapse" id="andean-latin-america">
      <div class="card card-block">
              <p>Venezuela <input type="checkbox"  class="Country" id="ALA" name="ALA" value="Venezuela" checked></p>
              <p>Colombia <input type="checkbox"  class="Country" id="ALA" name="ALA" value="Colombia" checked></p>
    </div>
</div>

<!--drop down for southern latin america-->
<p>
  <a style="margin-bottom:5px;" class="btn btn-danger" data-toggle="collapse" href="#collapseExample" aria-expanded="false" aria-controls="collapseExample" data-target="#southern-latin-america">Southern Latin America <!--<input style="margin-left: 5px; " type="checkbox"  class="Region"  id="CLA" name="CLA" value="Region" >--> </a><br>
</p>
    <div class="collapse" id="southern-latin-america">
      <div style="margin-bottom: 10px;" class="card card-block">
              <p>Argentina <input type="checkbox" class="Country" id="ALA" name="SLA" value="Argentina" checked></p>
              <p>Uruguay <input type="checkbox" class="Country" id="ALA" name="SLA" value="Uruguay" checked></p>
    </div>
</div>
              
            </form>
        </div>

        <!--middle content-->
        <div class="col-md-6 text-center">


              <!--radviz vis-->
              <div class="container">
              </div>

            <!--buttons-->
          <div style="margin-top: -30px;" class="btn-group text-center">
             <div class="btn-group" role="group">
              <button style="margin-right: 10px; margin-left: -50px;" type="button" onclick='allFilter()' class="btn btn-success">Apply</button>
        <button type="button" onclick='clearVis()' class="btn btn-danger">Reset</button>
      </div>  
       </div> 
                
          </div>
        

        <!--right content-->
        <div style="float:right;" class="col-md-3">
          <form class="form-group">
              <h6 style="padding-bottom: 10px;" class="font-weight-bold">Year</h6>

<!--80s decade-->
<p>
  <a style="margin-bottom:5px;" class="btn btn-info" data-toggle="collapse" href="#collapseExample" aria-expanded="false" aria-controls="collapseExample" data-target="#firstdecade">
    80's</a><br>
</p>
    <div class="collapse" id="firstdecade">
      <div style="margin-bottom: 10px;" class="card card-block">
        <p>1980 <input type="checkbox" name="year" value="1980" class="Year" checked></p>
        <p>1981 <input type="checkbox" name="year" value="1981" class="Year" checked></p>
        <p>1982 <input type="checkbox" name="year" value="1982" class="Year" checked></p>
        <p>1983 <input type="checkbox" name="year" value="1983" class="Year" checked></p>
        <p>1984 <input type="checkbox" name="year" value="1984" class="Year" checked></p>
         <p>1985 <input type="checkbox" name="year" value="1985" class="Year" checked></p>
         <p>1986 <input type="checkbox" name="year" value="1986" class="Year" checked></p>
         <p>1987 <input type="checkbox" name="year" value="1987" class="Year" checked></p> 
         <p>1988 <input type="checkbox" name="year" value="1988" class="Year" checked></p>
         <p>1989 <input type="checkbox" name="year" value="1989" class="Year" checked></p>
      </div>
</div>


<!--90s decade-->
<p>
  <a style="margin-bottom:5px;" class="btn btn-info" data-toggle="collapse" href="#collapseExample" aria-expanded="false" aria-controls="collapseExample" data-target="#seconddecade">
    90's</a><br>
</p>
    <div class="collapse" id="seconddecade">
      <div style="margin-bottom: 10px;" class="card card-block">
       <p>1990 <input type="checkbox" name="year" value="1990" class="Year" checked></p>
       <p>1991 <input type="checkbox" name="year" value="1991" class="Year" checked></p>
       <p>1992 <input type="checkbox" name="year" value="1992" class="Year" checked></p>
       <p>1993 <input type="checkbox" name="year" value="1993" class="Year" checked></p> 
       <p>1994 <input type="checkbox" name="year" value="1994" class="Year" checked></p>
       <p>1995 <input type="checkbox" name="year" value="1995" class="Year" checked></p>
       <p>1996 <input type="checkbox" name="year" value="1996" class="Year" checked></p>
       <p>1997 <input type="checkbox" name="year" value="1997" class="Year" checked></p>
       <p>1998 <input type="checkbox" name="year" value="1998" class="Year" checked></p>
       <p>1999 <input type="checkbox" name="year" value="1999" class="Year" checked></p>
    </div>
</div>



<!--00s decade-->
<p>
  <a style="margin-bottom:5px;" class="btn btn-info" data-toggle="collapse" href="#collapseExample" aria-expanded="false" aria-controls="collapseExample" data-target="#thirddecade">
    00's </a><br>
</p>
    <div class="collapse" id="thirddecade">
      <div style="margin-bottom: 10px;" class="card card-block">
       <p>2000 <input type="checkbox" name="year" value="2000" class="Year" checked></p>
       <p>2001 <input type="checkbox" name="year" value="2001" class="Year" checked></p>
       <p>2002 <input type="checkbox" name="year" value="2002" class="Year" checked></p>
       <p>2003 <input type="checkbox" name="year" value="2003" class="Year" checked></p>
       <p>2004 <input type="checkbox" name="year" value="2004" class="Year" checked></p>
       <p>2005 <input type="checkbox" name="year" value="2005" class="Year" checked></p>
       <p>2006 <input type="checkbox" name="year" value="2006" class="Year" checked></p>
       <p>2007 <input type="checkbox" name="year" value="2007" class="Year" checked></p>
       <p>2008 <input type="checkbox" name="year" value="2008" class="Year" checked></p>
       <p>2009 <input type="checkbox" name="year" value="2009" class="Year" checked></p>
       <p>2010 <input type="checkbox" name="year" value="2010" class="Year" checked></p>
       <p>2011 <input type="checkbox" name="year" value="2011" class="Year" checked></p>
       <p>2012 <input type="checkbox" name="year" value="2011" class="Year" checked></p>
       <p>2013 <input type="checkbox" name="year" value="2013" class="Year" checked></p>
       <p>2014 <input type="checkbox" name="year" value="2014" class="Year" checked></p>
    </div>
</div>
               
    </form>

          <!--gender filter-->
          <form style="padding-top: 20px;" class="form-group">
            <h6 style="padding-bottom: 5px;" class="font-weight-bold">Gender</h6>
            <table class="table">
              <tr>
                <td>
                    <p>Male <input type="checkbox" id="maleCheck" class="Gender" name="Male" value="Male" checked></p>
                    </td>
                    <td>
                       <p>Female <input type="checkbox" name="Female" class="Gender" id="femaleCheck" value="Female" checked></p>
                    </td>
              </tr>
            </table>
          </form>
          <!--radviz legend-->
          <div class="list-container">
                <div class="state"></div>
                <div class="year"></div>
                <div class="sex"></div>
          <div class="list"></div>

        </div>
    </div>
  </div>

<div  style="padding-top: 50px;" sclass="container">
    <div class="row">
    <div class="chart-wrapper" id="chart-line1"></div>
    </div>
    </div>
  </div>
</div>


    <div  class="row">
       <div class="col-md-4">
         <div class="obesitylinechartM"></div>
        </div>
        <div class="col-md-4">
         <div class="DiabeteslinechartM"></div>
        </div>
        <div class="col-md-4">
         <div class="RBPlinechartM"></div>
        </div> 
       </div>  
    </div>



    <div  class="row">
       <div class="col-md-4">
         <div class="obesitylinechartF"></div>
        </div>
        <div class="col-md-4">
         <div class="DiabeteslinechartF"></div>
        </div>
        <div class="col-md-4">
         <div class="RBPlinechartF"></div>
        </div> 
       </div>  
    </div>

    <script>
      
var dimensions = ['Diabetes','RBP', 'Obesity'];
var radviz = radvizComponent()
    .config({
        el: document.querySelector('.container'),
        colorAccessor: function(d) {
            return d['Country'];
        },
        colorScale: d3.scale
                      .ordinal()
                      .domain(["United States of America","Canada","Mexico","Costa Rica","Bermuda","Puerto Rico","Venezuela","Colombia","Argentina","Uruguay"])
                      .range(["#6284ba","#9ed0f1","#d1943a","#f2d19f","#9e43db","#c694e8","#58bc5a","#a1eda2","#7c1616","#ef9999"]), 
        dimensions: dimensions,
        size: 600,
        margin: 80,
        dotRadius: 2,
        zoomFactor: 1,
        drawLinks: false,
        useRepulsion: false,
        useTooltip: true,
        tooltipFormatter: function(d) {
                return '<h6>' +'&nbsp&nbsp&nbsp&nbsp'+ d.Country +'&nbsp&nbsp&nbsp&nbsp'+'</h6>' + 
            dimensions.map(function(dB) {
                    return;
                }).join('<br />');
        },

    });



d3.csv("NCD_RisC.csv", function(renderData) {     
    radviz.render(renderData); 
}); 

radviz.on('dotEnter', function(d){
    renderList(d); 
})

var renderList = function(datum) {


      //var parseDate = d3.time.format('%Y').parse;
      //datum.Year = parseDate(datum.Year.toString());

      d3.select('.state').text(datum.Country);
      d3.select('.year').text(datum.Year);
      d3.select('.sex').text(datum.Sex);

      //console.log("renderlist post", datum);

      //console.log(datum);

      var list = d3.select('.list-container')
          .selectAll('div.item')
          .data(dimensions);
      list.enter().append('div').classed('item', true);
      list.transition().style({
              width: function(d) {
                  return datum[d] * 100 + 'px';
              }
          })
          .text(function(d) {
              return d + ': ' + d3.format('%')(datum[d]);
              //console.log(datum['Obesity']);
          });
      
      list.exit().remove();
}
 

function getCountryChecked(){
        var checkboxes = document.getElementsByClassName('Country');
        var checkedBoxes = [];


    for (i = 0; i < checkboxes.length; i++) {

        if (checkboxes[i].checked == true)

            checkedBoxes.push(checkboxes[i].defaultValue);
    }

    return checkedBoxes;

    }

//function to get all checkedboxes for both male and female
function getGenderCheckedBoxes() {
    var genderCheckB = document.getElementsByClassName('Gender');
    var genderCheckedB = [];

    //console.log('genderCheckB', genderCheckB);
    for (i = 0; i < genderCheckB.length; i++) {
        if (genderCheckB[i].checked == true) {

            genderCheckedB.push(genderCheckB[i].defaultValue);
        }
    }
    return genderCheckedB;
}

//function to get all checkedboxes for year
function getYearCheckedBoxes(){
  var yearCheckB = document.getElementsByClassName('Year');
  var yearCheckedB = []; 

  for(i=0;i<yearCheckB.length;i++){
    if(yearCheckB[i].checked==true){
      yearCheckedB.push(yearCheckB[i].defaultValue);
    }

  }
  //console.log(yearCheckedB);
  return yearCheckedB; 
} 

function clearSVG(){
  d3.csv("NCD_RisC.csv",function(error, data){
    d3.select('svg').remove();
    radviz.render(data);
  });

}


//function for filtering using multiple data variables  e.g. gender and year
function allFilter() {
    
  
    d3.selectAll('.svg-container').remove();

    var countries = []; 
    countries = getCountryChecked();

    var genders = [];
    genders = getGenderCheckedBoxes();

    var years = []; 
    years = getYearCheckedBoxes();

    var margin = {top: 20, right: 50, bottom: 100, left: 50},
        width = 500 - margin.left - margin.right,
        height = 500 - margin.top - margin.bottom;

    // parse the date / time
    var parseDate = d3.time.format('%Y').parse;
    var formatPercent = d3.format(".0%");

    // Set the ranges
    var x = d3.time.scale().range([0, width]);
    var y = d3.scale.linear().range([height, 0]);

    // Define the axes
    var xAxis = d3.svg.axis().scale(x)
        .orient("bottom").ticks(5);

    var yAxis = d3.svg.axis().scale(y)
        .orient("left").ticks(5).tickFormat(formatPercent);
;

    // define the 1st line
    var countryLine = d3.svg.line()
        .x(function(d) { return x(d.Year); })
        .y(function(d) { return y(d.Obesity); });


    var svg = d3.select(".obesitylinechartM")
         .append("div")
         .classed("svg-container", true) //container class to make it responsive
         .append("svg")
         //responsive SVG needs these 2 attributes and no width and height attr
         .attr("preserveAspectRatio", "xMinYMin meet")
         .attr("viewBox", "0 0 600 400")
         //class to make it responsive
         .classed("svg-content-responsive", true)
         .attr("width", width + margin.left + margin.right)
         .attr("height", height + margin.top + margin.bottom)
         .append("g")
         .attr("transform",
              "translate(" + margin.left + "," + margin.top + ")");; 

  
  //filtering based on regions that are checked
  d3.csv("NCD_RisC.csv", function(parseData) {
    console.log("first load", parseData);
        d3.select("svg").remove();
        dataset = parseData.filter(function(d) {
        //if year is checked and region and gender are all checked
        return (years.indexOf(d['Year'])>-1 && genders.indexOf(d['Sex'])>-1 && countries.indexOf(d['Country'])>-1);
    });   

  radviz.render(dataset);
  //console.log('after',dataset);

  male_dataset = dataset.filter(function(d){
    return d.Sex!=="Female";
  }); 

  male_dataset.forEach(function(d){
      d.Year = parseDate(d.Year.toString());
      d.Obesity = +d.Obesity;
  });

    // Scale the range of the data
    x.domain(d3.extent(male_dataset, function(d) { return d.Year; }));
    y.domain([d3.min(male_dataset, function(d) { return d.Obesity; }), 
    d3.max(parseData, function(d) { return d.Obesity; })]); 

    //var color = d3.scale.ordinal().range(['#428bca','#f0ad4e','#5bc0de', '#d9534f', '#5cb85c']);


    var color = d3.scale
                      .ordinal()
                      .domain(["United States of America","Canada","Mexico","Costa Rica","Bermuda","Puerto Rico","Venezuela","Colombia","Argentina","Uruguay"])
                      .range(["#6284ba","#9ed0f1","#d1943a","#f2d19f","#9e43db","#c694e8","#58bc5a","#a1eda2","#7c1616","#ef9999"]);

    // Nest the entries by symbol
    var dataNest = d3.nest()
        .key(function(d) {return d.Country;})
        .entries(male_dataset);

  // Loop through each symbol / key
  dataNest.forEach(function(d) {
        svg.append("path")
            .attr("class", "line")
            .style("stroke", function(){
              return d.color = color(d.key); })
            .attr("d", countryLine(d.values)); 
    });

  svg.append("text")
      .attr("class", "y label")
      .attr("text-anchor", "end")
      .attr("y", 6)
      .attr("dy", ".75em")
      .attr("transform", "rotate(-90)")
      .text("Obesity Prevalence (Male)");

    // Add the X Axis
    svg.append("g")
        .attr("class", "x axis")
        .attr("transform", "translate(0," + height + ")")
        .call(xAxis);

    // Add the Y Axis
    svg.append("g")
        .attr("class", "y axis")
        .call(yAxis);

  maleDiabetesLineChart();
  maleRBPLineChart();

  femaleObesityLineChart();
  femaleDiabetesLineChart();
  femaleRBPLineChart();
});
}

function femaleObesityLineChart(){
    

    var countries = []; 
    countries = getCountryChecked();

    var genders = [];
    genders = getGenderCheckedBoxes();

    var years = []; 
    years = getYearCheckedBoxes();

    // set the dimensions and margins of the graph
    var margin = {top: 50, right: 50, bottom: 100, left: 50},
        width = 500 - margin.left - margin.right,
        height = 500 - margin.top - margin.bottom;

    // parse the date / time
    var parseDate = d3.time.format('%Y').parse;
    var formatPercent = d3.format(".0%");

    // Set the ranges
    var x = d3.time.scale().range([0, width]);
    var y = d3.scale.linear().range([height, 0]);

    // Define the axes
    var xAxis = d3.svg.axis().scale(x)
        .orient("bottom").ticks(5);

    var yAxis = d3.svg.axis().scale(y)
        .orient("left").ticks(5).tickFormat(formatPercent);
;

    // define the 1st line
    var countryLine = d3.svg.line()
        .x(function(d) { return x(d.Year); })
        .y(function(d) { return y(d.Obesity); });


    var svg = d3.select(".obesitylinechartF")
         .append("div")
         .classed("svg-container", true) //container class to make it responsive
         .append("svg")
         //responsive SVG needs these 2 attributes and no width and height attr
         .attr("preserveAspectRatio", "xMinYMin meet")
         .attr("viewBox", "0 0 600 400")
         //class to make it responsive
         .classed("svg-content-responsive", true)
         .attr("width", width + margin.left + margin.right)
         .attr("height", height + margin.top + margin.bottom)
         .append("g")
         .attr("transform",
              "translate(" + margin.left + "," + margin.top + ")");; 

  
  //filtering based on regions that are checked
  d3.csv("NCD_RisC.csv", function(datum) {
        d3.select("svg").remove();
        dataset = datum.filter(function(d) {
        //if year is checked and region and gender are all checked
        return (years.indexOf(d['Year'])>-1 && genders.indexOf(d['Sex'])>-1 && countries.indexOf(d['Country'])>-1);
    });   

  radviz.render(dataset);
  //console.log('after',dataset);

  female_dataset = dataset.filter(function(d){
    return d.Sex!=="Male";
  }); 

  female_dataset.forEach(function(d){
      d.Year = parseDate(d.Year.toString());
      d.Obesity = +d.Obesity;
  });

  //console.log(male_dataset);



    // Scale the range of the data
    x.domain(d3.extent(female_dataset, function(d) { return d.Year; }));
    y.domain([d3.min(female_dataset, function(d) { return d.Obesity; }), 
    d3.max(datum, function(d) { return d.Obesity; })]); 

    //var color = d3.scale.ordinal().range(['#428bca','#f0ad4e','#5bc0de', '#d9534f', '#5cb85c']);

    var color = d3.scale
                      .ordinal()
                      .domain(["United States of America","Canada","Mexico","Costa Rica","Bermuda","Puerto Rico","Venezuela","Colombia","Argentina","Uruguay"])
                      .range(["#6284ba","#9ed0f1","#d1943a","#f2d19f","#9e43db","#c694e8","#58bc5a","#a1eda2","#7c1616","#ef9999"]);

    // Nest the entries by symbol
    var dataNest = d3.nest()
        .key(function(d) {return d.Country;})
        .entries(female_dataset);

  // Loop through each symbol / key
  dataNest.forEach(function(d) {
        svg.append("path")
            .attr("class", "line")
            .style("stroke", function(){
              return d.color = color(d.key); })
            .attr("d", countryLine(d.values)); 
    });

  svg.append("text")
      .attr("class", "y label")
      .attr("text-anchor", "end")
      .attr("y", 6)
      .attr("dy", ".75em")
      .attr("transform", "rotate(-90)")
      .text("Obesity Prevalence (Female)");

    // Add the X Axis
    svg.append("g")
        .attr("class", "x axis")
        .attr("transform", "translate(0," + height + ")")
        .call(xAxis);

    // Add the Y Axis
    svg.append("g")
        .attr("class", "y axis")
        .call(yAxis);

});

}


function maleDiabetesLineChart(){


    var countries = []; 
    countries = getCountryChecked();

    var genders = [];
    genders = getGenderCheckedBoxes();

    var years = []; 
    years = getYearCheckedBoxes();

// set the dimensions and margins of the graph
    var margin = {top: 20, right: 50, bottom: 100, left: 50},
        width = 500 - margin.left - margin.right,
        height = 500 - margin.top - margin.bottom;

    // parse the date / time
    var parseDate = d3.time.format('%Y').parse;
    var formatPercent = d3.format(".0%");

    // Set the ranges
    var x = d3.time.scale().range([0, width]);
    var y = d3.scale.linear().range([height, 0]);

    // Define the axes
    var xAxis = d3.svg.axis().scale(x)
        .orient("bottom").ticks(5);

    var yAxis = d3.svg.axis().scale(y)
        .orient("left").ticks(5).tickFormat(formatPercent);
;

    // define the 1st line
    var countryLine = d3.svg.line()
        .x(function(d) { return x(d.Year); })
        .y(function(d) { return y(d.Diabetes); });


    
    var svg = d3.select(".DiabeteslinechartM")
         .append("div")
         .classed("svg-container", true) //container class to make it responsive
         .append("svg")
         //responsive SVG needs these 2 attributes and no width and height attr
         .attr("preserveAspectRatio", "xMinYMin meet")
         .attr("viewBox", "0 0 600 400")
         //class to make it responsive
         .classed("svg-content-responsive", true)
         .attr("width", width + margin.left + margin.right)
         .attr("height", height + margin.top + margin.bottom)
         .append("g")
         .attr("transform",
              "translate(" + margin.left + "," + margin.top + ")");;     
  

    //filtering based on regions that are checked
  d3.csv("NCD_RisC.csv", function(datum) {
        d3.select("svg").remove();
        dataset = datum.filter(function(d) {
        //if year is checked and region and gender are all checked
        return (years.indexOf(d['Year'])>-1 && genders.indexOf(d['Sex'])>-1 && countries.indexOf(d['Country'])>-1);
    });   

  radviz.render(dataset);      

  male_dataset = dataset.filter(function(d){
    return d.Sex!=="Female";
  }); 

  male_dataset.forEach(function(d){
      d.Year = parseDate(d.Year.toString());
      d.Diabetes = +d.Diabetes;
  });


    // Scale the range of the data
    x.domain(d3.extent(male_dataset, function(d) { return d.Year; }));
    y.domain([d3.min(male_dataset, function(d) { return d.Diabetes; }), 
    d3.max(datum, function(d) { return d.Diabetes; })]); 

    //var color = d3.scale.ordinal().range(['#428bca','#f0ad4e','#5bc0de', '#d9534f', '#5cb85c']);
    var color = d3.scale
                      .ordinal()
                      .domain(["United States of America","Canada","Mexico","Costa Rica","Bermuda","Puerto Rico","Venezuela","Colombia","Argentina","Uruguay"])
                      .range(["#6284ba","#9ed0f1","#d1943a","#f2d19f","#9e43db","#c694e8","#58bc5a","#a1eda2","#7c1616","#ef9999"]);

    // Nest the entries by symbol
    var dataNest = d3.nest()
        .key(function(d) {return d.Country;})
        .entries(male_dataset);

  // Loop through each symbol / key
  dataNest.forEach(function(d) {
        svg.append("path")
            .attr("class", "line")
            .style("stroke", function(){
              return d.color = color(d.key); })
            .attr("d", countryLine(d.values)); 
    });

  svg.append("text")
      .attr("class", "y label")
      .attr("text-anchor", "end")
      .attr("y", 6)
      .attr("dy", ".75em")
      .attr("transform", "rotate(-90)")
      .text("Diabetes Prevalence (Male)");

    // Add the X Axis
    svg.append("g")
        .attr("class", "x axis")
        .attr("transform", "translate(0," + height + ")")
        .call(xAxis);

    // Add the Y Axis
    svg.append("g")
        .attr("class", "y axis")
        .call(yAxis);
});    

}


function femaleDiabetesLineChart(){


    var countries = []; 
    countries = getCountryChecked();

    var genders = [];
    genders = getGenderCheckedBoxes();

    var years = []; 
    years = getYearCheckedBoxes();

// set the dimensions and margins of the graph
    var margin = {top: 50, right: 50, bottom: 100, left: 50},
        width = 500 - margin.left - margin.right,
        height = 500 - margin.top - margin.bottom;

    // parse the date / time
    var parseDate = d3.time.format('%Y').parse;
    var formatPercent = d3.format(".0%");

    // Set the ranges
    var x = d3.time.scale().range([0, width]);
    var y = d3.scale.linear().range([height, 0]);

    // Define the axes
    var xAxis = d3.svg.axis().scale(x)
        .orient("bottom").ticks(5);

    var yAxis = d3.svg.axis().scale(y)
        .orient("left").ticks(5).tickFormat(formatPercent);
;

    // define the 1st line
    var countryLine = d3.svg.line()
        .x(function(d) { return x(d.Year); })
        .y(function(d) { return y(d.Diabetes); });


    
    var svg = d3.select(".DiabeteslinechartF")
         .append("div")
         .classed("svg-container", true) //container class to make it responsive
         .append("svg")
         //responsive SVG needs these 2 attributes and no width and height attr
         .attr("preserveAspectRatio", "xMinYMin meet")
         .attr("viewBox", "0 0 600 400")
         //class to make it responsive
         .classed("svg-content-responsive", true)
         .attr("width", width + margin.left + margin.right)
         .attr("height", height + margin.top + margin.bottom)
         .append("g")
         .attr("transform",
              "translate(" + margin.left + "," + margin.top + ")");;     
  

    //filtering based on regions that are checked
  d3.csv("NCD_RisC.csv", function(datum) {
        d3.select("svg").remove();
        dataset = datum.filter(function(d) {
        //if year is checked and region and gender are all checked
        return (years.indexOf(d['Year'])>-1 && genders.indexOf(d['Sex'])>-1 && countries.indexOf(d['Country'])>-1);
    });   

  radviz.render(dataset);      

  female_dataset = dataset.filter(function(d){
    return d.Sex!=="Male";
  }); 

  female_dataset.forEach(function(d){
      d.Year = parseDate(d.Year.toString());
      d.Diabetes = +d.Diabetes;
  });


    // Scale the range of the data
    x.domain(d3.extent(female_dataset, function(d) { return d.Year; }));
    y.domain([d3.min(female_dataset, function(d) { return d.Diabetes; }), 
    d3.max(datum, function(d) { return d.Diabetes; })]); 

    //var color = d3.scale.ordinal().range(['#428bca','#f0ad4e','#5bc0de', '#d9534f', '#5cb85c']);
        var color = d3.scale
                      .ordinal()
                      .domain(["United States of America","Canada","Mexico","Costa Rica","Bermuda","Puerto Rico","Venezuela","Colombia","Argentina","Uruguay"])
                      .range(["#6284ba","#9ed0f1","#d1943a","#f2d19f","#9e43db","#c694e8","#58bc5a","#a1eda2","#7c1616","#ef9999"]);

    // Nest the entries by symbol
    var dataNest = d3.nest()
        .key(function(d) {return d.Country;})
        .entries(female_dataset);

  // Loop through each symbol / key
  dataNest.forEach(function(d) {
        svg.append("path")
            .attr("class", "line")
            .style("stroke", function(){
              return d.color = color(d.key); })
            .attr("d", countryLine(d.values)); 
    });

  svg.append("text")
      .attr("class", "y label")
      .attr("text-anchor", "end")
      .attr("y", 6)
      .attr("dy", ".75em")
      .attr("transform", "rotate(-90)")
      .text("Diabetes Prevalence (Female)");

    // Add the X Axis
    svg.append("g")
        .attr("class", "x axis")
        .attr("transform", "translate(0," + height + ")")
        .call(xAxis);

    // Add the Y Axis
    svg.append("g")
        .attr("class", "y axis")
        .call(yAxis);
});    

}


function maleRBPLineChart(){

    var countries = []; 
    countries = getCountryChecked();

    var genders = [];
    genders = getGenderCheckedBoxes();

    var years = []; 
    years = getYearCheckedBoxes();

// set the dimensions and margins of the graph
    var margin = {top: 20, right: 50, bottom: 100, left: 50},
        width = 500 - margin.left - margin.right,
        height = 500 - margin.top - margin.bottom;

    // parse the date / time
    var parseDate = d3.time.format('%Y').parse;
    var formatPercent = d3.format(".0%");

    // Set the ranges
    var x = d3.time.scale().range([0, width]);
    var y = d3.scale.linear().range([height, 0]);

    // Define the axes
    var xAxis = d3.svg.axis().scale(x)
        .orient("bottom").ticks(5);

    var yAxis = d3.svg.axis().scale(y)
        .orient("left").ticks(5).tickFormat(formatPercent);
;

    // define the 1st line
    var countryLine = d3.svg.line()
        .x(function(d) { return x(d.Year); })
        .y(function(d) { return y(d.RBP); });


    var svg = d3.select(".RBPlinechartM")
         .append("div")
         .classed("svg-container", true) //container class to make it responsive
         .append("svg")
         //responsive SVG needs these 2 attributes and no width and height attr
         .attr("preserveAspectRatio", "xMinYMin meet")
         .attr("viewBox", "0 0 600 400")
         //class to make it responsive
         .classed("svg-content-responsive", true)
         .attr("width", width + margin.left + margin.right)
         .attr("height", height + margin.top + margin.bottom)
         .append("g")
         .attr("transform",
              "translate(" + margin.left + "," + margin.top + ")");;     
  
  

    //filtering based on regions that are checked
  d3.csv("NCD_RisC.csv", function(datum) {
        d3.select("svg").remove();
        dataset = datum.filter(function(d) {
        //if year is checked and region and gender are all checked
        return (years.indexOf(d['Year'])>-1 && genders.indexOf(d['Sex'])>-1 && countries.indexOf(d['Country'])>-1);
    });   

  radviz.render(dataset);      

  RBP_male_dataset = dataset.filter(function(d){
    return d.Sex!=="Female";
  }); 

  RBP_male_dataset.forEach(function(d){
      d.Year = parseDate(d.Year.toString());
      d.RBP = +d.RBP;
  });



    // Scale the range of the data
    x.domain(d3.extent(RBP_male_dataset, function(d) { return d.Year; }));
    y.domain([d3.min(RBP_male_dataset, function(d) { return d.RBP; }), 
    d3.max(datum, function(d) { return d.RBP; })]); 

    //var color = d3.scale.ordinal().range(['#428bca','#f0ad4e','#5bc0de', '#d9534f', '#5cb85c']);

        var color = d3.scale
                      .ordinal()
                      .domain(["United States of America","Canada","Mexico","Costa Rica","Bermuda","Puerto Rico","Venezuela","Colombia","Argentina","Uruguay"])
                      .range(["#6284ba","#9ed0f1","#d1943a","#f2d19f","#9e43db","#c694e8","#58bc5a","#a1eda2","#7c1616","#ef9999"]);

    // Nest the entries by symbol
    var dataNest = d3.nest()
        .key(function(d) {return d.Country;})
        .entries(RBP_male_dataset);

  // Loop through each symbol / key
  dataNest.forEach(function(d) {
        svg.append("path")
            .attr("class", "line")
            .style("stroke", function(){
              return d.color = color(d.key); })
            .attr("d", countryLine(d.values)); 
    });

  svg.append("text")
      .attr("class", "y label")
      .attr("text-anchor", "end")
      .attr("y", 6)
      .attr("dy", ".75em")
      .attr("transform", "rotate(-90)")
      .text("RBP Prevalence (Male)");

    // Add the X Axis
    svg.append("g")
        .attr("class", "x axis")
        .attr("transform", "translate(0," + height + ")")
        .call(xAxis);

    // Add the Y Axis
    svg.append("g")
        .attr("class", "y axis")
        .call(yAxis);
}); 

}


function femaleRBPLineChart(){
    

    var countries = []; 
    countries = getCountryChecked();

    var genders = [];
    genders = getGenderCheckedBoxes();

    var years = []; 
    years = getYearCheckedBoxes();

// set the dimensions and margins of the graph
    var margin = {top: 50, right: 50, bottom: 100, left: 50},
        width = 500 - margin.left - margin.right,
        height = 500 - margin.top - margin.bottom;

    // parse the date / time
    var parseDate = d3.time.format('%Y').parse;
    var formatPercent = d3.format(".0%");

    // Set the ranges
    var x = d3.time.scale().range([0, width]);
    var y = d3.scale.linear().range([height, 0]);

    // Define the axes
    var xAxis = d3.svg.axis().scale(x)
        .orient("bottom").ticks(5);

    var yAxis = d3.svg.axis().scale(y)
        .orient("left").ticks(5).tickFormat(formatPercent);
;

    // define the 1st line
    var countryLine = d3.svg.line()
        .x(function(d) { return x(d.Year); })
        .y(function(d) { return y(d.RBP); });


    var svg = d3.select(".RBPlinechartF")
         .append("div")
         .classed("svg-container", true) //container class to make it responsive
         .append("svg")
         //responsive SVG needs these 2 attributes and no width and height attr
         .attr("preserveAspectRatio", "xMinYMin meet")
         .attr("viewBox", "0 0 600 400")
         //class to make it responsive
         .classed("svg-content-responsive", true)
         .attr("width", width + margin.left + margin.right)
         .attr("height", height + margin.top + margin.bottom)
         .append("g")
         .attr("transform",
              "translate(" + margin.left + "," + margin.top + ")");;     
  
  

    //filtering based on regions that are checked
  d3.csv("NCD_RisC.csv", function(datum) {

        d3.select("svg").remove();
        dataset = datum.filter(function(d) {
        //if year is checked and region and gender are all checked
        return (years.indexOf(d['Year'])>-1 && genders.indexOf(d['Sex'])>-1 && countries.indexOf(d['Country'])>-1);
        
    });   

  radviz.render(dataset);  
 // console.log("render",dataset);   

  RBP_female_dataset = dataset.filter(function(d){
    return d.Sex!=="Male";
    
  }); 

//console.log("filter by gender",RBP_female_dataset);

  RBP_female_dataset.forEach(function(d){
      d.Year = parseDate(d.Year.toString());
      d.RBP = +d.RBP;
  });

  var format = d3.time.format("%Y");


    // Scale the range of the data
    x.domain(d3.extent(RBP_female_dataset, function(d) { return d.Year; }));
    y.domain([d3.min(RBP_female_dataset, function(d) { return d.RBP; }), 
    d3.max(datum, function(d) { return d.RBP; })]); 

    

    var color = d3.scale
                      .ordinal()
                      .domain(["United States of America","Canada","Mexico","Costa Rica","Bermuda","Puerto Rico","Venezuela","Colombia","Argentina","Uruguay"])
                      .range(["#6284ba","#9ed0f1","#d1943a","#f2d19f","#9e43db","#c694e8","#58bc5a","#a1eda2","#7c1616","#ef9999"]);

    // Nest the entries by symbol
    var dataNest = d3.nest()
        .key(function(d) {return d.Country;})
        .entries(RBP_female_dataset);

  // Loop through each symbol / key
  dataNest.forEach(function(d) {
        svg.append("path")
            .attr("class", "line")
            .style("stroke", function(){
              return d.color = color(d.key); })
            .attr("d", countryLine(d.values)); 
    });

  svg.append("text")
      .attr("class", "y label")
      .attr("text-anchor", "end")
      .attr("y", 6)
      .attr("dy", ".75em")
      .attr("transform", "rotate(-90)")
      .text("RBP (Female)");

    // Add the X Axis
    svg.append("g")
        .attr("class", "x axis")
        .attr("transform", "translate(0," + height + ")")
        .call(xAxis);

    // Add the Y Axis
    svg.append("g")
        .attr("class", "y axis")
        .call(yAxis);
}); 

}

function clearVis(){
  location.reload();
}
    </script>

<link rel="stylesheet" type="text/css" href="CSS/style.css">
    <!-- jQuery first, then Tether, then Bootstrap JS. -->
    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
    <script src="//code.jquery.com/jquery-1.10.2.js"></script>
  </body>
</html>
